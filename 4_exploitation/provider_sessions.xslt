<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <!-- Output method is XML -->
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
        <providerSummaries>
            <!-- Loop through each provider -->
            <xsl:for-each select="platform/people/providers/provider">
                <provider>
                    <!-- Provider Name -->
                    <name><xsl:value-of select="name"/></name>
                    <!-- Provider Role -->
                    <role><xsl:value-of select="role"/></role>
                    <classes>
                        <!-- Loop through scheduled activities for this provider -->
                        <xsl:for-each select="/platform/activities/activity[provider_id=current()/@provider_id and status='Scheduled']">
                            <class>
                                <!-- Class Name -->
                                <name><xsl:value-of select="name"/></name>
                                <!-- Scheduled Start -->
                                <scheduledStart><xsl:value-of select="scheduledStart"/></scheduledStart>
                                <!-- Scheduled End -->
                                <scheduledEnd><xsl:value-of select="scheduledEnd"/></scheduledEnd>
                            </class>
                        </xsl:for-each>
                    </classes>
                </provider>
            </xsl:for-each>
        </providerSummaries>
    </xsl:template>
</xsl:stylesheet>
